Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.04s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  4.94s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.55s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:04<00:00, 36.96s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:04<00:00, 32.47s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:13<00:13, 13.74s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:17<00:00,  7.63s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:17<00:00,  8.55s/it]
/home/ctisseau/miniconda3/envs/clm_finetune/lib/python3.11/site-packages/outlines/fsm/guide.py:110: UserWarning: Outlines' public *community-contributed* CFG structured generation is experimental. Please review https://dottxt-ai.github.io/outlines/latest/reference/generation/cfg#disclaimer
  warnings.warn(
Epoch 1/3:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 1/3:   0%|          | 0/2 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/ctisseau/llm_lcd_finetune/test_cfg.py", line 174, in <module>
    finetune_test(
  File "/home/ctisseau/llm_lcd_finetune/test_cfg.py", line 133, in finetune_test
    biased_logits[i, j, :] = cfg.process_logits(batch_input_ids[i, :j].unsqueeze(0), logits[i, j, :])  # returns shape (batch, seq_len, vocab)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ctisseau/llm_lcd_finetune/ConstraintLM/constraintlm/processors/structured.py", line 67, in process_logits
    sorted_candidate_ids = candidate_ids[logits[i, candidate_ids].argsort(descending=True)]
                                         ~~~~~~^^^^^^^^^^^^^^^^^^
IndexError: too many indices for tensor of dimension 1
